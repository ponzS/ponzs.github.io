import{a as t}from"./utils-BrGt3VpK.js";import{c as n}from"./_commonjs-dynamic-modules-BHR_E30J.js";var e,o,i,r={exports:{}};function a(){return e||(e=1,t=r,function(){function e(t,o){return o?n(t):t.slice?e[i(t)]:function(n,o){t(n={exports:{}}),e[i(o)]=n.exports};function i(t){return t.split("/").slice(-1).toString().replace(".js","")}}var o=t;e(function(t){String.random=function(t,n){var e="";for(t=t||24,n=n||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";t-- >0;)e+=n.charAt(Math.floor(Math.random()*n.length));return e},String.match=function(t,n){var e,o;return"string"==typeof t&&("string"==typeof n&&(n={"=":n}),t===(e=(n=n||{})["="]||n["*"]||n[">"]||n["<"])||o===n["="]&&(e=n["*"]||n[">"],t.slice(0,(e||"").length)===e||o===n["*"]&&(o!==n[">"]&&o!==n["<"]?t>=n[">"]&&t<=n["<"]:o!==n[">"]&&t>=n[">"]||o!==n["<"]&&t<=n["<"])))},String.hash=function(t,n){if("string"==typeof t){if(n=n||0,!t.length)return n;for(var e=0,o=t.length;e<o;++e)n=(n<<5)-n+t.charCodeAt(e),n|=0;return n}};var n,e,o,i,r,a,s,u,c=Object.prototype.hasOwnProperty;Object.plain=function(t){return!!t&&(t instanceof Object&&t.constructor===Object||"Object"===Object.prototype.toString.call(t).match(/^\[object (\w+)\]$/)[1])},Object.empty=function(t,n){for(var e in t)if(c.call(t,e)&&(!n||-1==n.indexOf(e)))return!1;return!0},Object.keys=Object.keys||function(t){var n=[];for(var e in t)c.call(t,e)&&n.push(e);return n},i=setTimeout,r=0,a=0,s=typeof setImmediate!=""+n&&setImmediate||(typeof MessageChannel==""+n?i:((e=new MessageChannel).port1.onmessage=function(t){""==t.data&&o()},function(t){o=t,e.port2.postMessage("")})),u=i.check=i.check||typeof performance!=""+n&&performance||{now:function(){return+new Date}},i.hold=i.hold||9,i.poll=i.poll||function(t){i.hold>=u.now()-r&&a++<3333?t():s(function(){r=u.now(),t()},a=0)},function(){var t,n=setTimeout,e=n.turn=n.turn||function(t){1==o.push(t)&&i(a)},o=e.s=[],i=n.poll,r=0,a=function(){(t=o[r++])&&t(),r!=o.length&&99!=r||(o=e.s=o.slice(r),r=0),o.length&&i(a)}}(),function(){var t,n=setTimeout,e=n.turn;(n.each=n.each||function(n,o,i,r){r=r||9,function a(s,u,c){if(u=(s=(n||[]).splice(0,r)).length){for(var f=0;f<u&&t===(c=o(s[f]));f++);if(t===c)return void e(a)}i&&i(c)}()})()}()})(e,"./shim"),e(function(t){t.exports=function t(n,e,o){if(!n)return{to:t};var i="function"==typeof e;if(n=(this.tag||(this.tag={}))[n]||i&&(this.tag[n]={tag:n,to:t._={next:function(t){var n;(n=this.to)&&n.next(t)}}}),i){var r={off:t.off||(t.off=function(){if(this.next===t._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=t._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:t._,next:e,the:n,on:this,as:o};return(r.back=n.last||n).to=r,n.last=r}return(n=n.to)&&void 0!==e&&n.next(e),n}})(e,"./onto"),e(function(t){t.exports=function(t){return null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t&&t!=1/0&&t!=-1/0&&t==t||!!t&&"string"==typeof t["#"]&&1===Object.keys(t).length&&t["#"]}})(e,"./valid"),e(function(t){function n(){var t=+new Date;return s<t?(r=0,s=t+n.drift):s=t+(r+=1)/a+n.drift}e("./shim"),n.drift=0;var o,i=-1/0,r=0,a=999,s=i;n.is=function(t,n,e){var o=n&&t&&t._&&t._[">"]||e;if(o)return"number"==typeof(o=o[n])?o:i},n.ify=function(t,n,e,i,r){(t=t||{})._=t._||{},r&&(t._["#"]=r);var a=t._[">"]||(t._[">"]={});return o!==n&&"_"!==n&&("number"==typeof e&&(a[n]=e),o!==i&&(t[n]=i)),t},t.exports=n})(e,"./state"),e(function(t){e("./shim"),t.exports=function(t){var n={s:{}},e=n.s;t=t||{max:999,age:9e3},n.check=function(t){return!!e[t]&&o(t)};var o=n.track=function(i){var r=e[i]||(e[i]={});return r.was=n.now=+new Date,n.to||(n.to=setTimeout(n.drop,t.age+9)),o.ed&&o.ed(i),r};return n.drop=function(o){n.to=null,n.now=+new Date;var i=Object.keys(e);console.STAT&&console.STAT(n.now,+new Date-n.now,"dup drop keys"),setTimeout.each(i,function(i){var r=e[i];r&&(o||t.age)>n.now-r.was||delete e[i]},0,99)},n}})(e,"./dup"),e(function(t){e("./onto"),t.exports=function(t,e){if(this.on){var o=(this.opt||{}).lack||9e3;if("function"!=typeof t){if(!t)return;var i=t["#"]||t,r=(this.tag||"")[i];if(!r)return;return e&&(r=this.on(i,e),clearTimeout(r.err),r.err=setTimeout(function(){r.off()},o)),!0}if(i=e&&e["#"]||n(9),!t)return i;var a=this.on(i,t,e);return a.err=a.err||setTimeout(function(){a.off(),a.next({err:"Error: No ACK yet.",lack:!0})},o),i}};var n=String.random||function(){return Math.random().toString(36).slice(2)}})(e,"./ask"),e(function(t){function n(t){return t instanceof n?(this._={$:this}).$:this instanceof n?n.create(this._={$:this,opt:t}):new n(t)}n.is=function(t){return t instanceof n||t&&t._&&t===t._.$||!1},n.version=.202,n.chain=n.prototype,n.chain.toJSON=function(){},e("./shim"),n.valid=e("./valid"),n.state=e("./state"),n.on=e("./onto"),n.dup=e("./dup"),n.ask=e("./ask"),function(){function t(o){if(o)if(o.out!==t){var i,r=this.as,u=r.at||r,c=u.$,f=u.dup,l=o.DBG;if((i=o["#"])||(i=o["#"]=s(9)),!f.check(i)){if(f.track(i),i=o._,o._="function"==typeof i?i:function(){},o.$&&o.$===(o.$._||"").$||(o.$=c),o["@"]&&!o.put&&function(t){var n,e=t["@"]||"";if(n=e._)n.acks=(n.acks||0)+1,(n.err=t.err)&&(t["@"]=n["#"],a(n)),n.ok=t.ok||n.ok,n.stop||n.crack||(n.crack=n.match&&n.match.push(function(){p(n)})),p(n);else{var o=(o=t.$)&&(o=o._)&&(o=o.root)&&(o=o.dup);if(!(o=o.check(e)))return;t["@"]=o["#"]||t["@"]}}(o),!u.ask(o["@"],o)){if(l&&(l.u=+new Date),o.put)return void e(o);o.get&&n.on.get(o,c)}l&&(l.uc=+new Date),this.to.next(o),l&&(l.ua=+new Date),o.nts||o.NTS||(o.out=t,u.on("out",o),l&&(l.ue=+new Date))}}else this.to.next(o)}function e(n){if(n){var e=n._||"",r=e.root=((e.$=n.$||"")._||"").root;if(n["@"]&&e.faith&&!e.miss)return n.out=t,void r.on("out",n);e.latch=r.hatch,e.match=r.hatch=[];var s=n.put,f=e.DBG=n.DBG,l=+new Date;if(d=d||l,!s["#"]||!s["."]){f&&(f.p=l),e["#"]=n["#"],e.msg=n,e.all=0,e.stun=1;var h=Object.keys(s);console.STAT&&console.STAT(l,((f||e).pk=+new Date)-l,"put sort");var p,y,k,m,_,w,$,j=0;!function t(r){if(p!=j){if(p=j,!(k=h[j]))return console.STAT&&console.STAT(l,((f||e).pd=+new Date)-l,"put"),void a(e);(m=s[k])?($=m._)?k!==$["#"]?w=g+v(k)+"soul not same.":(_=$[">"])||(w=g+v(k)+"no state."):w=g+v(k)+"no meta.":w=g+v(k)+"no node.",y=Object.keys(m||{})}if(w)return n.err=e.err=w,void a(e);var d,x=0;for(r=r||0;r++<9&&(d=y[x++]);)if("_"!==d){var T=m[d],S=_[d];if(i===S){w=g+v(d)+"on"+v(k)+"no state.";break}if(!c(T)){w=g+v(d)+"on"+v(k)+"bad "+typeof T+v(T);break}o(T,d,k,S,n),++b}(y=y.slice(x)).length?u(t):(++j,y=null,t(r))}()}}}function o(t,n,e,i,r){var a,s=r._||"",u=s.root,c=u.graph,l=c[e]||h,p=f(l,n,1),d=l[n],g=s.DBG;(a=console.STAT)&&(c[e]&&d||(a.has=(a.has||0)+1));var v=m();if(i>v)return setTimeout(function(){o(t,n,e,i,r)},(a=i-v)>k?k:a),void(console.STAT&&console.STAT((g||s).Hf=+new Date,a,"future"));if(!(i<p)&&(s.faith||i!==p||!(t===d||y(t)<=y(d))||s.miss)){s.stun++;var b=r["#"]+s.all++,_={toString:function(){return b},_:s};_.toJSON=_.toString,u.dup.track(_)["#"]=r["#"],g&&(g.ph=g.ph||+new Date),u.on("put",{"#":_,"@":r["@"],put:{"#":e,".":n,":":t,">":i},ok:r.ok,_:s})}}function r(t){var n;(n=(t._||"").DBG)&&(n.pa=+new Date,n.pm=n.pm||+new Date);var e,o=this.as,i=o.graph,r=t._,s=t.put,u=s["#"],c=s["."],f=s[":"],h=s[">"];t["#"],(e=r.msg)&&(e=e.put)&&(e=e[u])&&l(e,c,h,f,u),i[u]=l(i[u],c,h,f,u),(e=(o.next||"")[u])&&e.on("in",t),a(r),this.to.next(t)}function a(n,e){var o;if(!n.stop&&(n.err||!(0<--n.stun))&&(n.stop=1,o=n.root)){var i=n.match;i.end=1,i===o.hatch&&(!(i=n.latch)||i.end?delete o.hatch:o.hatch=i),n.hatch&&n.hatch(),setTimeout.each(n.match,function(t){t&&t()}),!(e=n.msg)||n.err||e.err||(e.out=t,n.root.on("out",e),_())}}function p(t){t&&t.root&&(t.stun||t.acks!==t.all||t.root.on("in",{"@":t["#"],err:t.err,ok:t.err?i:t.ok||{"":1}}))}n.create=function(e){e.root=e.root||e,e.graph=e.graph||{},e.on=e.on||n.on,e.ask=e.ask||n.ask,e.dup=e.dup||n.dup();var o=e.$.opt(e.opt);return e.once||(e.on("in",t,e),e.on("out",t,e),e.on("put",r,e),n.on("create",e),e.on("create",e)),e.once=1,o},n.on.put=e;var d,g="Error: Invalid graph!",v=function(t){return" '"+(""+t).slice(0,9)+"...' "},y=JSON.stringify,k=2147483647,m=n.state,b=0,_=function(){b>999&&b/-(d-(d=+new Date))>1&&(n.window&&console.log("Warning: You're syncing 1K+ records a second, faster than DOM can update - consider limiting query."),_=function(){b=0})}}(),function(){function t(t,n){var e=+new Date,o=t._||{},r=o.DBG=t.DBG,a=t["#"],u=s(9),c=Object.keys(n||"").sort(),h=((n||"")._||"")["#"];c.length;var p=t.$._.root,d=n===p.graph[h];console.STAT&&console.STAT(e,((r||o).gk=+new Date)-e,"got keys"),n&&function t(){e=+new Date;for(var o,g,v,y=0,k={};y<9&&(o=c[y++]);)l(k,o,f(n,o),n[o],h);c=c.slice(y),(g={})[h]=k,k=g,d&&((v=function(){}).ram=v.faith=!0),g=c.length,console.STAT&&console.STAT(e,-(e-(e=+new Date)),"got copied some"),r&&(r.ga=+new Date),p.on("in",{"@":a,"#":u,put:k,"%":g?u=s(9):i,$:p.$,_:v,DBG:r,FOO:1}),console.STAT&&console.STAT(e,+new Date-e,"got in"),g&&setTimeout.turn(t)}(),n||p.on("in",{"@":t["#"]})}n.on.get=function(n,e){var o=e._,r=n.get,a=r["#"],s=o.graph[a],u=r["."],c=(o.next||(o.next={}))[a],h=(n._||{}).DBG=n.DBG;if(h&&(h.g=+new Date),!s)return o.on("get",n);if(u){if(("string"!=typeof u||i===s[u])&&!((c||"").next||"")[u])return void o.on("get",n);s=l({},u,f(s,u),s[u],a)}s&&t(n,s),o.on("get",n)},n.on.get.ack=t}(),n.chain.opt=function(t){t=t||{};var e=this._,o=t.peers||t;return Object.plain(t)||(t={}),Object.plain(e.opt)||(e.opt=t),"string"==typeof o&&(o=[o]),Object.plain(e.opt.peers)||(e.opt.peers={}),o instanceof Array&&(t.peers={},o.forEach(function(n){var o={};o.id=o.url=n,t.peers[n]=e.opt.peers[n]=e.opt.peers[n]||o})),a(t,function t(n){var e=this[n];this&&this.hasOwnProperty(n)||"string"==typeof e||Object.empty(e)?this[n]=e:(!e||e.constructor===Object||e instanceof Array)&&a(e,t)}),e.opt.from=t,n.on("opt",e),e.opt.uuid=e.opt.uuid||function(t){return n.state().toString(36).replace(".","")+String.random(t||12)},this};var i,r,a=function(t,n){Object.keys(t).forEach(n,t)},s=String.random,u=setTimeout.turn,c=n.valid,f=n.state.is,l=n.state.ify,h={};n.log=function(){return!n.log.off&&r.log.apply(r,arguments),[].slice.call(arguments).join(" ")},n.log.once=function(t,e,o){return(o=n.log.once)[t]=o[t]||0,o[t]++||n.log(e)},"undefined"!=typeof window&&((window.GUN=window.Gun=n).window=window);try{void 0!==o&&(o.exports=n)}catch(p){}t.exports=n,(n.window||{}).console=(n.window||{}).console||{log:function(){}},(r=console).only=function(t,n){return r.only.i&&t===r.only.i&&r.only.i++&&(r.log.apply(r,arguments)||n)},n.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, please ask for help on http://chat.gun.eco if anything takes you longer than 5min to figure out!")})(e,"./root"),e(function(t){e("./root").chain.back=function(t,e){if(-1===(t=t||1)||1/0===t)return this._.root.$;if(1===t)return(this._.back||this._).$;var i=this._;if("string"==typeof t&&(t=t.split(".")),t instanceof Array){for(var r=0,a=t.length,s=i;r<a;r++)s=(s||o)[t[r]];return n!==s?e?this:s:(s=i.back)?s.$.back(t,e):void 0}if("function"==typeof t){var u;for(s={back:i};(s=s.back)&&n===(u=t(s,e)););return u}return"number"==typeof t?(i.back||i).$.back(t-1):this};var n,o={}})(e,"./back"),e(function(t){var n=e("./root");function o(t,e){if(e=e||this.as||t.$._,(!t.$$||this===n.on)&&t.put&&!e.soul){var o=t.put||"",i=o["="]||o[":"],r=e.root,a=r.$.get(o["#"]).get(o["."])._;if("string"==typeof(i=c(i))){if(!(a.echo||(a.echo={}))[e.id]||(r.pass||"")[e.id]){if(s=r.pass){if(s[i+e.id])return;s[i+e.id]=1}(a.echo||(a.echo={}))[e.id]=e,e.has&&(e.link=i);var s,u=r.$.get(a.link=i)._;(u.echo||(u.echo={}))[a.id]=a,((s=e.ask||"")[""]||e.lex)&&u.on("out",{get:{"#":i}}),setTimeout.each(Object.keys(s),function(t,n){t&&(n=s[t])&&n.on("out",{get:{"#":i,".":t}})},0,99)}}else this===n.on&&((a.echo||(a.echo={}))[e.id]=e)}}function i(t,n){var e,o,r=t.put||"",s=a!==r["="]?r["="]:r[":"],u=n.root;if(a===s){if(n.soul&&a!==n.put)return;if(o=(t.$$||t.$||"")._||"",t["@"]&&(a!==o.put||a!==n.put))return;return(e=n.link||t.linked)&&delete(u.$.get(e)._.echo||"")[n.id],n.has&&(n.link=null),n.put=a,void setTimeout.each(Object.keys(n.next||""),function(t,o){(o=n.next[t])&&(e&&delete(u.$.get(e).get(t)._.echo||"")[o.id],o.on("in",{get:t,put:a,$:o.$}))},0,99)}n.soul||t.$$||(e=c(s),o=t.$._||"",(e!==o.link&&(!n.has||o.link)||(u.pass||"")[n.id]&&"string"!=typeof e)&&(delete(o.echo||"")[n.id],i({get:n.get,put:a,$:t.$,linked:t.linked=t.linked||o.link},n)))}function r(t,e){var o=this.as,i=o.$._;i.root;var r=o.get||"",s=(t.put||"")[r["#"]]||"";if(!t.put||"string"==typeof r["."]&&a===s[r["."]]){if(a!==i.put)return;if(!i.soul&&!i.has)return;return i.ack=(i.ack||0)+1,void i.on("in",{get:i.get,put:i.put=a,$:i.$,"@":t["@"]})}(t._||{}).miss=1,n.on.put(t)}n.chain.chain=function(t){var e,o=this,i=o._,r=new(t||o).constructor(o),a=r._;return a.root=e=i.root,a.id=++e.once,a.back=o._,a.on=n.on,a.on("in",n.on.in,a),a.on("out",n.on.out,a),r},n.on.out=function(t){var n,e,o=this.as,i=o.back,s=o.root;if(t.$||(t.$=o.$),this.to.next(t),!o.err){if(n=t.get){if(s.pass&&(s.pass[o.id]=o),o.lex&&Object.keys(o.lex).forEach(function(t){e[t]=o.lex[t]},e=t.get=t.get||{}),n["#"]||o.soul){if(n["#"]=n["#"]||o.soul,t["#"]||(t["#"]=u(9)),i=s.$.get(n["#"])._,n=n["."]){if(f(i.put,n)&&(e=i.ask&&i.ask[n],(i.ask||(i.ask={}))[n]=i.$.get(n)._,i.on("in",{get:n,put:{"#":i.soul,".":n,":":i.put[n],">":h(s.graph[i.soul],n)}}),e))return}else{if(e=i.ask&&i.ask[""],(i.ask||(i.ask={}))[""]=i,a!==i.put&&(i.on("in",i),e))return;t.$=i.$}return s.ask(r,t),s.on("in",t)}if(n["."])return o.get?(t={get:{".":o.get},$:o.$},(i.ask||(i.ask={}))[o.get]=t.$._,i.on("out",t)):(t={get:o.lex?t.get:{},$:o.$},i.on("out",t));if((o.ask||(o.ask={}))[""]=o,o.get)return n["."]=o.get,(i.ask||(i.ask={}))[o.get]=t.$._,i.on("out",t)}return i.on("out",t)}o.on("in",{put:o.put=a,$:o.$})},n.on.in=function(t,n){var e,r=(n=n||this.as).root,u=t.$||(t.$=n.$),f=(u||"")._||s,l=t.put||"",d=l["#"],g=l["."],v=a!==l["="]?l["="]:l[":"],y=l[">"]||-1/0;if(a!==t.put&&(a===l["#"]||a===l["."]||a===l[":"]&&a===l["="]||a===l[">"]))return c(l)?void n.on("in",{$:f.back.$,put:{"#":d=f.back.soul,".":g=f.has||f.get,"=":l,">":h(f.back.put,g)},via:t}):(d=((l||"")._||"")["#"])?(u=n.root.$.get(d),setTimeout.each(Object.keys(l).sort(),function(e){"_"!=e&&a!==(y=h(l,e))&&n.on("in",{$:u,put:{"#":d,".":e,"=":l[e],">":y},VIA:t})})):void console.log("chain not yet supported for",l,"...",t,n);(t.seen||"")[n.id]||((t.seen||(t.seen=function(){}))[n.id]=n,n!==f&&(Object.keys(t).forEach(function(n){l[n]=t[n]},l={}),l.get=n.get||l.get,n.soul||n.has?f.soul&&(l.$=n.$,l.$$=l.$$||f.$):l.$$$=l.$$$||n.$,t=l),i(t,n),(n.soul||t.$$)&&y>=h(r.graph[d],g)&&((l=r.$.get(d)._).put=p(l.put,g,y,v,d)),!f.soul&&y>=h(r.graph[d],g)&&(e=(r.$.get(d)._.next||"")[g])&&(e.put=v,"string"==typeof(l=c(v))&&(e.put=r.$.get(l)._.put||v)),this.to&&this.to.next(t),n.any&&setTimeout.each(Object.keys(n.any),function(e){(e=n.any[e])&&e(t)},0,99),n.echo&&setTimeout.each(Object.keys(n.echo),function(e){(e=n.echo[e])&&e.on("in",t)},0,99),((t.$$||"")._||f).soul&&(e=n.next)&&(e=e[g])&&(l={},Object.keys(t).forEach(function(n){l[n]=t[n]}),l.$=(t.$$||t.$).get(l.get=g),delete l.$$,delete l.$$$,e.on("in",l)),o(t,n))},n.on.link=o,n.on.unlink=i;var a,s={},u=String.random,c=n.valid,f=function(t,n){return t&&Object.prototype.hasOwnProperty.call(t,n)},l=n.state,h=l.is,p=l.ify})(e,"./chain"),e(function(t){var n=e("./root");function o(t){var n=this.at||this.on;if(!t||n.soul||n.has)return this.off();if(t=(t=(t=t.$||t)._||t).id){var e;if(n.map,(e=this.seen||(this.seen={}))[t])return!0;e[t]=!0}}n.chain.get=function(t,e,s){var u,c;if("string"==typeof t){if(0==t.length)return(u=this.chain())._.err={err:n.log("0 length key!",t)},e&&e.call(u,u._.err),u;(u=((l=this._).next||r)[t])||(u=t&&function(t,n){var e=n._,o=e.next,i=n.chain(),r=i._;return o||(o=e.next={}),o[r.get=t]=r,n===e.root.$?r.soul=t:(e.soul||e.has)&&(r.has=t),r}(t,this)),u=u&&u.$}else{if("function"==typeof t){let r=function(t,e,o){if(!r.stun&&(!(a=p.pass)||a[f])){var a,s=t.$._,u=(t.$$||"")._,c=(u||s).put,g=!s.has&&!s.soul,v={};if((g||i===c)&&(c=i===((a=t.put)||"")["="]?i===(a||"")[":"]?a:a[":"]:a["="]),"string"==typeof(a=n.valid(c))&&(c=i===(a=p.$.get(a)._.put)?h.not?i:c:a),!h.not||i!==c){if(i===h.stun){if((a=p.stun)&&a.on&&(l.$.back(function(t){if(a.on(""+t.id,v={}),(v.run||0)<r.id)return v}),!v.run&&a.on(""+s.id,v={}),!v.run&&u&&a.on(""+u.id,v={}),r.id>v.run&&(v.stun&&!v.stun.end||(v.stun=a.on("stun"),v.stun=v.stun&&v.stun.last),v.stun&&!v.stun.end)))return void((v.stun.add||(v.stun.add={}))[f]=function(){r(t,e,1)});if(i===c&&(o=0),(a=p.hatch)&&!a.end&&i===h.hatch&&!o){if(d[s.$._.id])return;return d[s.$._.id]=1,void a.push(function(){r(t,e,1)})}d={}}if(p.pass){if(p.pass[f+s.id])return;p.pass[f+s.id]=1}h.on?h.ok.call(s.$,c,s.get,t,e||r):h.v2020?h.ok(t,e||r):(Object.keys(t).forEach(function(n){a[n]=t[n]},a={}),(t=a).put=c,h.ok.call(h.as,t,e||r))}}};if(!0===e)return function(t,e,o,r){var a,s=t._,u=0;(a=s.soul||s.link)?e(a,r,s):s.jam?s.jam.push([e,r]):(s.jam=[[e,r]],t.get(function(t,e){if(!(i===t.put&&!s.root.opt.super&&(a=Object.keys(s.root.opt.peers).length)&&++u<=a)){e.rid(t);var o,r=(r=t.$)&&r._||{},c=0;for(a=s.jam,delete s.jam;o=a[c++];){var f=o[0];o=o[1],f&&f(r.link||r.soul||n.valid(t.put)||((t.put||{})._||{})["#"],o,t,e)}}},{out:{get:{".":!0}}}))}(this,t,0,s),this;var f,l=(u=this)._,h=e||{},p=l.root;h.at=l,h.ok=t;var d={};return r.at=l,(l.any||(l.any={}))[f=String.random(7)]=r,r.off=function(){r.stun=1,l.any&&delete l.any[f]},r.rid=o,r.id=h.run||++p.once,c=p.pass,(p.pass={})[f]=1,h.out=h.out||{get:{}},l.on("out",h.out),p.pass=c,u}if("number"==typeof t)return this.get(""+t,e,s);if("string"==typeof(c=a(t)))return this.get(c,e,s);(c=this.get.next)&&(u=c(this,t))}return u?(e&&"function"==typeof e&&u.get(e,s),u):((u=this.chain())._.err={err:n.log("Invalid get request!",t)},e&&e.call(u,u._.err),u)};var i,r={},a=n.valid})(e,"./get"),e(function(t){var n=e("./root");function o(t,e){if(e){e=(e._||"").id||e;var o,i=t.root.stun||(t.root.stun={on:n.on}),r={};t.stun||(t.stun=i.on("stun",function(){})),(o=i.on(""+e))&&o.the.last.next(r),r.run>=t.run||i.on(""+e,function(n){if(t.stun.end)return this.off(),void this.to.next(n);n.run=n.run||t.run,n.stun=n.stun||t.stun})}}function i(t){if(t.err)i.end(t.stun,t.root);else if(!t.todo.length&&!t.end&&Object.empty(t.wait)){t.end=1;var e,o=t.$.back(-1)._,r=o.root,a=o.ask(function(e){r.on("ack",e),e.err&&!e.lack&&n.log(e),++s>(t.acks||0)&&this.off(),t.ack&&t.ack(e,this)},t.opt),s=0,u=t.stun;(e=function(){u&&(i.end(u,r),setTimeout.each(Object.keys(u=u.add||""),function(t){(t=u[t])&&t()}))}).hatch=e,t.ack&&!t.ok&&(t.ok=t.acks||9),t.via._.on("out",{put:t.out=t.graph,ok:t.ok&&{"@":t.ok+1},opt:t.opt,"#":a,_:e})}}n.chain.put=function(t,e,a){var f=this,l=f._,h=l.root;(a=a||{}).root=l.root,a.run||(a.run=h.once),o(a,l.id),a.ack=a.ack||e,a.via=a.via||f,a.data=a.data||t,a.soul||(a.soul=l.soul||"string"==typeof e&&e);var p=a.state=a.state||n.state();return"function"==typeof t?(t(function(t){a.data=t,f.put(r,r,a)}),f):a.soul?(a.$=h.$.get(a.soul),a.todo=[{it:a.data,ref:a.$}],a.turn=a.turn||s,a.ran=a.ran||i,function t(){var e,r,s,f,l,h=a.todo,d=h.pop(),g=d.it;if(d.ref&&d.ref._.id,o(a,d.ref),(f=d.todo)&&(g=g[r=f.pop()],f.length&&h.push(d)),r&&(h.path||(h.path=[])).push(r),!(e=u(g))&&!(l=n.is(g))){if(!Object.plain(g))return void i.err(a,"Invalid data: "+function(t,n){return t&&(n=t.constructor)&&n.name||typeof t}(g)+" at "+(a.via.back(function(t){t.get&&f.push(t.get)},f=[])||f.join("."))+"."+(h.path||[]).join("."));for(var v=a.seen||(a.seen=[]),y=v.length;y--;)if(g===(f=v[y]).it){e=g=f.link;break}}if(r&&e)d.node=c(d.node,r,p,g);else{let t=function(n,e){var i=s.link["#"];e&&(e.off(),e.rid(n));var r=i||n.soul||(f=(n.$$||n.$)._||"").soul||f.link||((f=f.put||"")._||"")["#"]||f["#"]||((f=n.put||"")&&n.$$?f["#"]:(f["="]||f[":"]||"")["#"]);!i&&o(a,n.$),r||d.link["#"]?(r||(r=[],(n.$$||n.$).back(function(t){if(f=t.soul||t.link)return r.push(f);r.push(t.get)}),r=r.reverse().join("/")),s.link["#"]=r,!l&&(((a.graph||(a.graph={}))[r]=s.node||(s.node={_:{}}))._["#"]=r),delete a.wait[k],s.wait&&setTimeout.each(s.wait,function(t){t&&t()}),a.ran(a)):(d.wait||(d.wait=[])).push(function(){t(n,e)})};if(!a.seen)return void i.err(a,"Data at root of graph must be a node (an object).");a.seen.push(s={it:g,link:{},todo:l?[]:Object.keys(g).sort().reverse(),path:(h.path||[]).slice(),up:d}),d.node=c(d.node,r,p,s.link),!l&&s.todo.length&&h.push(s);var k=a.seen.length;(a.wait||(a.wait={}))[k]="",f=(s.ref=l?g:r?d.ref.get(r):d.ref)._,(f=g&&(g._||"")["#"]||f.soul||f.link)?t({soul:f}):s.ref.get(t,{run:a.run,v2020:1,out:{get:{".":" "}}})}if(!h.length)return a.ran(a);a.turn(t)}(),f):(function(t){var n,e=t.via._;t.via=t.via.back(function(e){if(e.soul||!e.get)return e.$;n=t.data,(t.data={})[e.get]=n}),t.via&&t.via._.soul||(t.via=e.root.$.get(((t.data||"")._||"")["#"]||e.$.back("opt.uuid")())),t.via.put(t.data,t.ack,t)}(a),f)},i.end=function(t,n){t.end=a,t.the.to===t&&t===t.the.last&&delete n.stun,t.off()},i.err=function(t,e){(t.ack||a).call(t,t.out={err:t.err=n.log(e)}),t.ran(t)};var r,a=function(){},s=setTimeout.turn,u=n.valid,c=n.state.ify})(e,"./put"),e(function(t){var n=e("./root");e("./chain"),e("./back"),e("./put"),e("./get"),t.exports=n})(e,"./index"),e(function(t){var n,o=e("./index");o.chain.on=function(t,n,e,o){var i,r=this,a=r._;if(a.root,"string"==typeof t)return n?(i=a.on(t,n,e||a,o),e&&e.$&&(e.subs||(e.subs=[])).push(i),r):a.on(t);var s=n;return(s=!0===s?{change:!0}:s||{}).not=1,s.on=1,r.get(t,s),r},o.chain.once=function(t,e){if(e=e||{},!t)return function(t,n,e){return o.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),(e=t.chain())._.nix=t.once(function(t,n){e._.on("in",this._)}),e._.lex=t._.lex,e}(this);var i=this,r=i._,a=r.root;r.put;var s,u=String.random(7);return i.get(function(i,c,f,l){var h=this,p=h._,d=p.one||(p.one={});function g(v){p.has||p.soul||(p={put:i,get:c}),n===(s=p.put)&&(s=((f.$$||"")._||"").put),"string"!=typeof o.valid(s)||(s=a.$.get(s)._.put)!==n||v?l.stun||""!==d[u]&&(d[u]="",(r.soul||r.has)&&l.off(),t.call(h,s,p.get),clearTimeout(d[u])):d[u]=setTimeout(function(){g(1)},e.wait||99)}l.stun||""!==d[u]&&(!0!==(s=o.valid(i))?"string"!=typeof s&&(clearTimeout((r.one||"")[u]),clearTimeout(d[u]),d[u]=setTimeout(g,e.wait||99)):g())},{on:1}),i},o.chain.off=function(){var t,n=this._,e=n.back;if(e)return n.ack=0,(t=e.next)&&t[n.get]&&delete t[n.get],(t=e.any)&&(delete e.any,e.any={}),(t=e.ask)&&delete t[n.get],(t=e.put)&&delete t[n.get],(t=n.soul)&&delete e.root.graph[t],(t=n.map)&&Object.keys(t).forEach(function(n,o){(o=t[n]).link&&e.root.$.get(o.link).off()}),(t=n.next)&&Object.keys(t).forEach(function(n,e){t[n].$.off()}),n.on("off",{}),this}})(e,"./on"),e(function(t){var n=e("./index"),o=n.chain.get.next;function i(t){this.to.next(t);var e,o=this.as,i=t.$._,r=t.put;(i.soul||t.$$)&&((e=o.lex)&&!String.match(t.get||(r||"")["."],e["."]||e["#"]||e)||n.on.link(t,o))}n.chain.get.next=function(t,n){var e;return Object.plain(n)?(e=((e=n["#"])||"")["="]||e)?t.get(e):((e=t.chain()._).lex=n,t.on("in",function(t){String.match(t.get||(t.put||"")["."],n["."]||n["#"]||n)&&e.on("in",t),this.to.next(t)}),e.$):(o||a)(t,n)},n.chain.map=function(t,e,o){var s,u,c=this,f=c._;return Object.plain(t)&&(s=t["."]?t:{".":t},t=r),t?(n.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),u=c.chain(),c.map().on(function(e,o,i,s){var c=(t||a).call(this,e,o,i,s);if(r!==c){if(e===c)return u._.on("in",i);if(n.is(c))return u._.on("in",c._);var f={};Object.keys(i.put).forEach(function(t){f[t]=i.put[t]},f),f["="]=c,u._.on("in",{get:o,put:f})}}),u):((u=f.each)||((f.each=u=c.chain())._.lex=s||u._.lex||f.lex,u._.nix=c.back("nix"),c.on("in",i,u._)),u)};var r,a=function(){}})(e,"./map"),e(function(t){var n=e("./index");n.chain.set=function(t,e,o){var i,r,a=this,s=a.back(-1);return e=e||function(){},(o=o||{}).item=o.item||t,(i=((t||"")._||"")["#"])&&((t={})["#"]=i),"string"==typeof(r=n.valid(t))?a.get(i=r).put(t,e,o):n.is(t)?(a.put(function(o){t.get(function(t,i,s){if(!t)return e.call(a,{err:n.log('Only a node can be linked! Not "'+s.put+'"!')});(r={})[t]={"#":t},o(r)},!0)}),t):(Object.plain(t)&&(t=s.get(i=a.back("opt.uuid")()).put(t)),a.get(i||s.back("opt.uuid")(7)).put(t,e,o))}})(e,"./set"),e(function(t){e("./shim");var n,o=function(){},i=JSON.parseAsync||function(t,n,e){var o=+new Date;try{n(void 0,JSON.parse(t,e),r.sucks(+new Date-o))}catch(i){n(i)}},r=JSON.stringifyAsync||function(t,n,e,o){var i=+new Date;try{n(void 0,JSON.stringify(t,e,o),r.sucks(+new Date-i))}catch(a){n(a)}};r.sucks=function(t){t>99&&(console.log("Warning: JSON blocking CPU detected. Add `gun/lib/yson.js` to fix."),r.sucks=o)};try{t.exports=function(t){var e=function(){},o=t.opt||{};o.log=o.log||console.log,o.gap=o.gap||o.wait||0,o.max=o.max||.3*(o.memory?999*o.memory*999:3e8),o.pack=o.pack||.01*o.max*.01,o.puff=o.puff||9;var a=setTimeout.turn||setTimeout,s=t.dup,u=s.check,c=s.track,f=e.hear=function(t,n){if(t){if(o.max<=t.length)return e.say({dam:"!",err:"Message too big!"},n);e===this&&(f.d+=t.length||0,++f.c);var r,s=n.SH=+new Date,u=t[0];return"["===u?(i(t,function(t,i){if(t||!i)return e.say({dam:"!",err:"DAM JSON parse error."},n);console.STAT&&console.STAT(+new Date,i.length,"# on hear batch");var r=o.puff;!function t(){for(var o,s=+new Date,u=0;u<r&&(o=i[u++]);)e.hear(o,n);i=i.slice(u),console.STAT&&console.STAT(s,+new Date-s,"hear loop"),l(n),i.length&&a(t,0)}()}),void(t="")):"{"===u||(t["#"]||Object.plain(t))&&(r=t)?r?f.one(r,n,s):void i(t,function(t,o){if(t||!o)return e.say({dam:"!",err:"DAM JSON parse error."},n);f.one(o,n,s)}):void 0}};function l(t){var n=t.batch,e="string"==typeof n;if(e&&(n+="]"),t.batch=t.tail=null,n&&!(e?3>n.length:!n.length)){if(!e)try{n=1===n.length?n[0]:JSON.stringify(n)}catch(i){return o.log("DAM JSON stringify error",i)}n&&h(n,t)}}function h(t,n){try{var o=n.wire;n.say?n.say(t):o.send&&o.send(t),e.say.d+=t.length||0,++e.say.c}catch(i){(n.queue=n.queue||[]).push(t)}}return f.one=function(n,o,i){var r,a,f,l,h;if(n.DBG&&(n.DBG=h={DBG:n.DBG}),h&&(h.h=i),h&&(h.hp=+new Date),(r=n["#"])||(r=n["#"]=String.random(9)),!((f=u(r))||(a=n["##"])&&(f=n["@"]||n.get&&r)&&s.check(l=f+a))){if((n._=function(){}).via=e.leap=o,(f=n["><"])&&"string"==typeof f&&f.slice(0,99).split(",").forEach(function(t){this[t]=1},n._.yo={}),f=n.dam)return(f=e.hear[f])&&f(n,o,t),void c(r);(f=n.ok)&&(n._.near=f["/"]),i=+new Date,h&&(h.is=i),o.SI=r,c.ed=function(t){r===t&&(c.ed=0,(t=s.s[r])&&(t.via=o,n.get&&(t.it=n)))},t.on("in",e.last=n),h&&(h.hd=+new Date),console.STAT&&console.STAT(i,+new Date-i,n.get?"msg get":n.put?"msg put":"msg"),c(r),l&&c(l),e.leap=e.last=null}},f.c=f.d=0,function(){var t,i=0;function f(t,n){var e;return n instanceof Object?(Object.keys(n).sort().forEach(p,{to:e={},on:n}),e):n}function p(t){this.to[t]=this.on[t]}e.hash=function(t,n){var o,i,s,u=+new Date;r(t.put,function r(c,f){var l=(i||(i=s=f||"")).slice(0,32768);o=String.hash(l,o),(i=i.slice(32768))?a(r,0):(console.STAT&&console.STAT(u,+new Date-u,"say json+hash"),t._.$put=s,t["##"]=o,e.say(t,n),delete t._.$put)},f)},(e.say=function(r,u){var f;if((f=this)&&(f=f.to)&&f.next&&f.next(r),!r)return!1;var p,d,g,v=r["@"],y=r._||(r._=function(){}),k=r.DBG,m=+new Date;if(y.y=y.y||m,u||k&&(k.y=m),(p=r["#"])||(p=r["#"]=String.random(9)),!t&&c(p),(d=r["##"])||n===r.put||y.via||!v){if(!u&&v&&(u=(f=s.s[v])&&(f.via||(f=f.it)&&(f=f._)&&f.via)||(f=e.last)&&v===f["#"]&&e.leap),!u&&v){if(s.s[v])return;return console.STAT&&console.STAT(+new Date,++i,"total no peer to ack to"),!1}if(v&&!r.put&&!d&&((s.s[v]||"").it||"")["##"])return!1;if(!u&&e.way)return e.way(r);if(k&&(k.yh=+new Date),g=y.raw){if(k&&(k.yr=+new Date),!u||!u.id){if(!Object.plain(u||o.peers))return!1;m=+new Date,o.puff;var b=o.peers,_=Object.keys(u||o.peers||{});return console.STAT&&console.STAT(m,+new Date-m,"peer keys"),void function n(){var o=+new Date;t=1;var i=y.raw;y.raw=g;for(var s,f=0;f<9&&(s=(_||"")[f++]);)(s=b[s]||(u||"")[s])&&e.say(r,s);y.raw=i,t=0,_=_.slice(f),console.STAT&&console.STAT(o,+new Date-o,"say loop"),_.length&&(a(n,0),v&&c(v))}()}if(!u.wire&&e.wire&&e.wire(u),p!==u.last){if(u.last=p,u===y.via)return!1;if((f=y.yo)&&(f[u.url]||f[u.pid]||f[u.id]))return!1;if(console.STAT&&console.STAT(m,((k||y).yp=+new Date)-(y.y||m),"say prep"),!t&&v&&c(v),u.batch){if(u.tail=(f=u.tail||0)+g.length,u.tail<=o.pack)return void(u.batch+=(f?",":"")+g);l(u)}u.batch="[";var w=+new Date;setTimeout(function(){console.STAT&&console.STAT(w,+new Date-w,"0ms TO"),l(u)},o.gap),h(g,u),console.STAT&&v===u.SI&&console.STAT(m,+new Date-u.SH,"say ack")}}else e.raw(r,u)}else e.hash(r,u)}).c=e.say.d=0,e.raw=function(t,i){if(!t)return"";var a,c,f=t._||{};if(c=f.raw)return c;if("string"==typeof t)return t;var l=t["##"],h=t["@"];if(l&&h){if(!f.via&&u(h+l))return!1;if(c=(s.s[h]||"").it){if(l===c["##"])return!1;c["##"]||(c["##"]=l)}}if(!t.dam&&!t["@"]){var p=0,d=[];for(var g in c=o.peers){var v=c[g];if(d.push(v.url||v.pid||v.id),++p>6)break}p>1&&(t["><"]=d.join())}if(t.put&&(c=t.ok)&&(t.ok={"@":(c["@"]||1)-1,"/":c["/"]==t._.near?e.near:c["/"]}),a=f.$put)return c={},Object.keys(t).forEach(function(n){c[n]=t[n]}),c.put=":])([:",void r(c,function(t,e){if(!t){var o=+new Date;c=e.indexOf('"put":":])([:"'),y(n,e=e.slice(0,c+6)+a+e.slice(c+14)),console.STAT&&console.STAT(o,+new Date-o,"say slice")}});function y(n,o){n||(f.raw=o,e.say(t,i))}r(t,y)}}(),e.near=0,e.hi=function(n){var i;n.wire?(n.id?o.peers[n.url||n.id]=n:(i=n.id=n.id||n.url||String.random(9),e.say({dam:"?",pid:t.opt.pid},o.peers[i]=n),delete s.s[n.last]),n.met||(e.near++,n.met=+new Date,t.on("hi",n)),i=n.queue,n.queue=[],setTimeout.each(i||[],function(t){h(t,n)},0,9)):e.wire(n.length&&{url:n,id:n}||n)},e.bye=function(n){n.met&&--e.near,delete n.met,t.on("bye",n);var o=+new Date;o-=n.met||o,e.bye.time=((e.bye.time||o)+o)/2},e.hear["!"]=function(t,n){o.log("Error:",t.err)},e.hear["?"]=function(t,n){t.pid&&(n.pid||(n.pid=t.pid),t["@"])||(e.say({dam:"?",pid:o.pid,"@":t["#"]},n),delete s.s[n.last])},e.hear.mob=function(t,n){if(t.peers){var o=Object.keys(t.peers),i=o[Math.random()*o.length|0];i&&(e.bye(n),e.hi(i))}},t.on("create",function(t){t.opt.pid=t.opt.pid||String.random(9),this.to.next(t),t.on("out",e.say)}),t.on("bye",function(t,n){t=o.peers[t.id||t]||t,this.to.next(t),t.bye?t.bye():(n=t.wire)&&n.close&&n.close(),delete o.peers[t.id],t.wire=null}),t.on("bye",function(t,n){this.to.next(t),(n=console.STAT)&&(n.peers=e.near),(n=t.url)&&setTimeout(function(){},o.lack||9e3)}),t.on("hi",function(n,i){if(this.to.next(n),(i=console.STAT)&&(i.peers=e.near),!o.super){var r=Object.keys(t.next||"");r.length>9999&&!console.SUBS&&console.log(console.SUBS="Warning: You have more than 10K live GETs, which might use more bandwidth than your screen can show - consider `.off()`."),setTimeout.each(r,function(i){var r=t.next[i];o.super||(r.ask||"")[""]?e.say({get:{"#":i}},n):setTimeout.each(Object.keys(r.ask||""),function(o){o&&e.say({"##":String.hash((t.graph[i]||"")[o]),get:{"#":i,".":o}},n)})})}}),e}}catch(a){}})(e,"./mesh"),e(function(t){var n=e("./index");n.Mesh=e("./mesh"),n.on("opt",function(t){if(this.to.next(t),!t.once){var e=t.opt;if(!1!==e.WebSocket){var o=n.window||{},i=e.WebSocket||o.WebSocket||o.webkitWebSocket||o.mozWebSocket;if(i){e.WebSocket=i;var r=e.mesh=e.mesh||n.Mesh(t);r.wire||e.wire,r.wire=e.wire=u,setTimeout(function(){!e.super&&t.on("out",{dam:"hi"})},1);var a=1998,s=""+void 0!=typeof document&&document}}}function u(t){try{if(!t||!t.url)return o&&o(t);var n=t.url.replace(/^http/,"ws"),o=t.wire=new e.WebSocket(n);return o.onclose=function(){c(t),e.mesh.bye(t)},o.onerror=function(n){c(t)},o.onopen=function(){e.mesh.hi(t)},o.onmessage=function(n){n&&e.mesh.hear(n.data||n,t)},o}catch(i){e.mesh.bye(t)}}function c(t){clearTimeout(t.defer),e.peers[t.url]&&(s&&t.retry<=0||(t.retry=(t.retry||e.retry+1||60)-(-t.tried+(t.tried=+new Date)<4*a?1:0),t.defer=setTimeout(function n(){if(s&&s.hidden)return setTimeout(n,a);u(t)},a)))}})})(e,"./websocket"),e(function(t){if("undefined"!=typeof Gun){var n;try{n=(Gun.window||function(){}).localStorage}catch(o){}n||(Gun.log("Warning: No localStorage exists to persist data to!"),n={setItem:function(t,n){this[t]=n},removeItem:function(t){delete this[t]},getItem:function(t){return this[t]}});var e=JSON.stringifyAsync||function(t,n,e,i){try{n(void 0,JSON.stringify(t,e,i))}catch(o){n(o)}};Gun.on("create",function t(i){this.to.next(i);var r=i.opt;i.graph;var a,s,u,c,f=[];if(!1!==r.localStorage){r.prefix=r.file||"gun/";try{a=t[r.prefix]=t[r.prefix]||JSON.parse(u=n.getItem(r.prefix))||{}}catch(o){a=t[r.prefix]={}}u=(u||"").length,i.on("get",function(t){this.to.next(t);var n,e,o,i=t.get;i&&(n=i["#"])&&((e=a[n]||void 0)&&(o=i["."])&&!Object.plain(o)&&(e=Gun.state.ify({},o,Gun.state.is(e,o),e[o],n)),Gun.on.get.ack(t,e))}),i.on("put",function(t){this.to.next(t);var n=t.put,e=n["#"],o=n["."],r=t["#"],h=t.ok||"";(i.next||"")[e]&&(a[e]=Gun.state.ify(a[e],o,n[">"],n[":"],e),c&&u>4999880?i.on("in",{"@":r,err:"localStorage max!"}):(t["@"]||t._.via&&!(Math.random()<h["@"]/h["/"])||f.push(r),s||(s=setTimeout(l,9+u/333))))})}function l(){if(f.length||!((setTimeout.turn||"").s||"").length){var t=f;clearTimeout(s),s=!1,f=[],e(a,function(e,s){try{!e&&n.setItem(r.prefix,s)}catch(o){e=c=o||"localStorage failure"}e&&(Gun.log(e+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),i.on("localStorage:error",{err:e,get:r.prefix,put:a})),u=s.length,setTimeout.each(t,function(t){i.on("in",{"@":t,err:e,ok:0})},0,99)})}else setTimeout(l,99)}})}})(e,"./localStorage")}(),function(){if(""+w!=typeof Gun){var t=function(t){console.warn("Warning! Deprecated internal utility will break in next version:",t)},n=Gun;n.fn=n.fn||{is:function(n){return t("fn"),!!n&&"function"==typeof n}},n.bi=n.bi||{is:function(n){return t("bi"),n instanceof Boolean||"boolean"==typeof n}},n.num=n.num||{is:function(n){return t("num"),!o(n)&&(n-parseFloat(n)+1>=0||1/0===n||-1/0===n)}},n.text=n.text||{is:function(n){return t("text"),"string"==typeof n}},n.text.ify=n.text.ify||function(e){return t("text.ify"),n.text.is(e)?e:"undefined"!=typeof JSON?JSON.stringify(e):e&&e.toString?e.toString():e},n.text.random=n.text.random||function(n,e){t("text.random");var o="";for(n=n||24,e=e||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";n>0;)o+=e.charAt(Math.floor(Math.random()*e.length)),n--;return o},n.text.match=n.text.match||function(n,e){var o,i;return t("text.match"),"string"==typeof n&&("string"==typeof e&&(e={"=":e}),n===(o=(e=e||{})["="]||e["*"]||e[">"]||e["<"])||i===e["="]&&(o=e["*"]||e[">"]||e["<"],n.slice(0,(o||"").length)===o||i===e["*"]&&(i!==e[">"]&&i!==e["<"]?n>=e[">"]&&n<=e["<"]:i!==e[">"]&&n>=e[">"]||i!==e["<"]&&n<=e["<"])))},n.text.hash=n.text.hash||function(n,e){if(t("text.hash"),"string"==typeof n){if(e=e||0,!n.length)return e;for(var o=0,i=n.length;o<i;++o)e=(e<<5)-e+n.charCodeAt(o),e|=0;return e}},n.list=n.list||{is:function(n){return t("list"),n instanceof Array}},n.list.slit=n.list.slit||Array.prototype.slice,n.list.sort=n.list.sort||function(n){return t("list.sort"),function(t,e){return t&&e?(t=t[n])<(e=e[n])?-1:t>e?1:0:0}},n.list.map=n.list.map||function(n,e,o){return t("list.map"),a(n,e,o)},n.list.index=1,n.obj=n.boj||{is:function(n){return t("obj"),!!n&&(n instanceof Object&&n.constructor===Object||"Object"===Object.prototype.toString.call(n).match(/^\[object (\w+)\]$/)[1])}},n.obj.put=n.obj.put||function(n,e,o){return t("obj.put"),(n||{})[e]=o,n},n.obj.has=n.obj.has||function(n,e){return t("obj.has"),n&&Object.prototype.hasOwnProperty.call(n,e)},n.obj.del=n.obj.del||function(n,e){if(t("obj.del"),n)return n[e]=null,delete n[e],n},n.obj.as=n.obj.as||function(n,e,o,i){return t("obj.as"),n[e]=n[e]||(i===o?{}:o)},n.obj.ify=n.obj.ify||function(n){if(t("obj.ify"),i(n))return n;try{n=JSON.parse(n)}catch(e){n={}}return n},function(){function e(t,n){r(this,n)&&void 0!==this[n]||(this[n]=t)}n.obj.to=n.obj.to||function(n,o){return t("obj.to"),a(n,e,o=o||{}),o}}(),n.obj.copy=n.obj.copy||function(n){return t("obj.copy"),n?JSON.parse(JSON.stringify(n)):n},function(){function e(t,n){var e=this.n;if(!e||!(n===e||i(e)&&r(e,n)))return void 0!==n||void 0}n.obj.empty=n.obj.empty||function(n,o){return t("obj.empty"),!n||!a(n,e,{n:o})}}(),function(){function e(t,n){if(2===arguments.length)return e.r=e.r||{},void(e.r[t]=n);e.r=e.r||[],e.r.push(t)}var a,s=Object.keys;Object.keys=Object.keys||function(t){return a(t,function(t,n,e){e(n)})},n.obj.map=a=n.obj.map||function(a,u,c){t("obj.map");var f,l,h,p,d,g=0,v="function"==typeof u;if(e.r=f,s&&i(a)&&(p=s(a),d=!0),c=c||{},o(a)||p)for(l=(p||a).length;g<l;g++){var y=g+n.list.index;if(v){if((h=d?u.call(c,a[p[g]],p[g],e):u.call(c,a[g],y,e))!==f)return h}else if(u===a[d?p[g]:g])return p?p[g]:y}else for(g in a)if(v){if(r(a,g)&&(h=c?u.call(c,a[g],g,e):u(a[g],g,e))!==f)return h}else if(u===a[g])return g;return v?e.r:n.list.index?0:-1}}(),n.time=n.time||{},n.time.is=n.time.is||function(n){return t("time"),n?n instanceof Date:+(new Date).getTime()};var e=n.fn.is,o=n.list.is,i=(_=n.obj).is,r=_.has,a=_.map,s={is:function(n){return t("val.is"),n!==w&&(null===n||n!==1/0&&(!!(l(n)||c(n)||f(n))||s.link.is(n)||!1))}};s.link=s.rel={_:"#"},function(){function n(t,n){var e=this;return e.id?e.id=!1:n==u&&l(t)?void(e.id=t):e.id=!1}s.link.is=function(e){if(t("val.link.is"),e&&e[u]&&!e._&&i(e)){var o={};if(a(e,n,o),o.id)return o.id}return!1}}(),s.link.ify=function(n){return t("val.link.ify"),h({},u,n)},n.obj.has._=".";var u=s.link._,c=n.bi.is,f=n.num.is,l=n.text.is,h=(i=(_=n.obj).is,_.put);a=_.map,n.val=n.val||s;var p={_:"_",soul:function(n,e){return t("node.soul"),n&&n._&&n._[e||v]}};p.soul.ify=function(n,e){return t("node.soul.ify"),e="string"==typeof e?{soul:e}:e||{},(n=n||{})._=n._||{},n._[v]=e.soul||n._[v]||g(),n},p.soul._=s.link._,function(){function n(t,n){if(n!==p._)return!s.is(t)||void(this.cb&&this.cb.call(this.as,t,n,this.n,this.s))}p.is=function(e,o,r){var s;return t("node.is"),!!i(e)&&!!(s=p.soul(e))&&!a(e,n,{as:r,cb:o,s:s,n:e})}}(),function(){function n(t,n){var e,o=this.o;o.map?void 0===(e=o.map.call(this.as,t,""+n,o.node))?d(o.node,n):o.node&&(o.node[n]=e):s.is(t)&&(o.node[n]=t)}p.ify=function(e,o,i){return t("node.ify"),o?"string"==typeof o?o={soul:o}:"function"==typeof o&&(o={map:o}):o={},o.map&&(o.node=o.map.call(i,e,w,o.node||{})),(o.node=p.soul.ify(o.node||{},o))&&a(e,n,{o:o,as:i}),o.node}}(),i=(_=n.obj).is;var d=_.del,g=(a=_.map,n.text.random),v=p.soul._;n.node=n.node||p;var y=n.state;y.lex=function(){return t("state.lex"),y().toString(36).replace(".","")},y.to=function(n,e,o){t("state.to");var r=(n||{})[e];return i(r)&&(r=k(r)),y.ify(o,e,y.is(n,e),r,p.soul(n))},function(){function n(t,n){m!==n&&y.ify(this.o,n,this.s)}y.map=function(o,s,u){var c;t("state.map");var l=i(l=o||s)?l:null;return o=e(o=o||s)?o:null,l&&!o?(s=f(s)?s:y(),l[m]=l[m]||{},a(l,n,{o:l,s:s}),l):(u=u||i(s)?s:c,s=f(s)?s:y(),function(t,e,i,a){if(!o)return n.call({o:i,s:s},t,e),t;o.call(u||this||{},t,e,i,a),r(i,e)&&c===i[e]||n.call({o:i,s:s},t,e)})}}(),(_=n.obj).as,r=_.has,i=_.is,a=_.map;var k=_.copy,m=(f=n.num.is,e=n.fn.is,p._),b={};!function(){function n(t,n){if(!t||n!==p.soul(t)||!p.is(t,this.fn,this.as))return!0;this.cb&&(e.n=t,e.as=this.as,this.cb.call(e.as,t,n,e))}function e(t){t&&p.is(e.n,t,e.as)}b.is=function(e,o,r,s){return t("graph.is"),!(!e||!i(e)||$(e)||a(e,n,{cb:o,fn:r,as:s}))}}(),function(){function e(t,n){var e;return(e=function(t,n){for(var e,o=t.seen,i=o.length;i--;)if(e=o[i],n.obj===e.obj)return e;o.push(n)}(t,n))?e:(n.env=t,n.soul=a,p.ify(n.obj,o,n)&&(n.link=n.link||s.link.ify(p.soul(n.node)),n.obj!==t.shell&&(t.graph[s.link.is(n.link)]=n.node)),n)}function o(t,n,o){var i,a,c=this,f=c.env;if(p._===n&&r(t,s.link._))return o._;if(i=u(t,n,o,c,f)){if(n||(c.node=c.node||o||{},r(t,p._)&&p.soul(t)&&(c.node._=k(t._)),c.node=p.soul.ify(c.node,s.link.is(c.link)),c.link=c.link||s.link.ify(p.soul(c.node))),(a=f.map)&&(a.call(f.as||{},t,n,o,c),r(o,n))){if(t=o[n],w===t)return void d(o,n);if(!(i=u(t,n,o,c,f)))return}if(!n)return c.node;if(!0===i)return t;if((a=e(f,{obj:t,path:c.path.concat(n)})).node)return a.link}}function a(t){var n=this,e=s.link.is(n.link),o=n.env.graph;n.link=n.link||s.link.ify(t),n.link[s.link._]=t,n.node&&n.node[p._]&&(n.node[p._][s.link._]=t),r(o,e)&&(o[t]=o[e],d(o,e))}function u(t,e,o,r,a){var c;return!!s.is(t)||(i(t)?1:(c=a.invalid)?u(t=c.call(a.as||{},t,e,o),e,o,r,a):(a.err="Invalid value at '"+r.path.concat(e).join(".")+"'!",void(n.list.is(t)&&(a.err+=" Use `.set(item)` instead of an Array."))))}b.ify=function(n,o,i){t("graph.ify");var r={path:[],obj:n};return o?"string"==typeof o?o={soul:o}:"function"==typeof o&&(o.map=o):o={},"string"==typeof i&&(o.soul=o.soul||i,i=w),o.soul&&(r.link=s.link.ify(o.soul)),o.shell=(i||{}).shell,o.graph=o.graph||{},o.seen=o.seen||[],o.as=o.as||i,e(o,r),o.root=r.node,o.graph}}(),b.node=function(n){t("graph.node");var e=p.soul(n);if(e)return h({},e,n)},function(){function n(t,n){var e,o;if(p._!==n)(e=s.link.is(t))?(o=this.opt.seen[e])?this.obj[n]=o:this.obj[n]=this.opt.seen[e]=b.to(this.graph,e,this.opt):this.obj[n]=t;else{if($(t,s.link._))return;this.obj[n]=k(t)}}b.to=function(e,o,i){if(t("graph.to"),e){var r={};return i=i||{seen:{}},a(e[o],n,{obj:r,graph:e,opt:i}),r}}}(),e=n.fn.is,i=(_=n.obj).is,d=_.del,r=_.has;var _,w,$=_.empty;h=_.put,a=_.map,k=_.copy,n.graph=n.graph||b}}()),r.exports;var t}const s=t(i?o:(i=1,o=a())),u=Object.freeze(Object.defineProperty({__proto__:null,default:s},Symbol.toStringTag,{value:"Module"}));export{u as b};
