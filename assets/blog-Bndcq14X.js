import{v as e,j as t,i as a}from"./index-CwfwMfXG.js";const o=e("blog",()=>{const e=t(null),o=t(!1),l=t(null),r=t(null),s=t(""),n=t(null),u=t(null),i=a(()=>e.value?.posts||[]),c=a(()=>e.value?.categories||[]),g=a(()=>e.value?.tags||[]),d=a(()=>i.value.filter(e=>e.featured)),v=a(()=>[...i.value].sort((e,t)=>new Date(t.publishDate).getTime()-new Date(e.publishDate).getTime()).slice(0,6)),f=a(()=>{let e=i.value;if(n.value&&(e=e.filter(e=>e.category.toLowerCase()===n.value?.toLowerCase()||c.value.find(e=>e.id===n.value)?.name===e.category)),u.value&&(e=e.filter(e=>e.tags.some(e=>e.toLowerCase()===u.value?.toLowerCase()))),s.value.trim()){const t=s.value.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(t)||e.excerpt.toLowerCase().includes(t)||e.content.toLowerCase().includes(t)||e.tags.some(e=>e.toLowerCase().includes(t)))}return e}),w=a(()=>r.value?i.value.filter(e=>e.id!==r.value.id&&(e.category===r.value.category||e.tags.some(e=>r.value.tags.includes(e)))).slice(0,3):[]);function C(e){return i.value.find(t=>t.slug===e)}function m(e){r.value=e}return{blogData:e,loading:o,error:l,currentPost:r,searchQuery:s,selectedCategory:n,selectedTag:u,posts:i,categories:c,tags:g,featuredPosts:d,latestPosts:v,filteredPosts:f,relatedPosts:w,loadBlogData:async function(t="zh"){o.value=!0,l.value=null;try{const a="en"===t?"/data/blog-en.json":"/data/blog-zh.json",o=await fetch(a);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const l=await o.json();e.value=l}catch(a){l.value=a instanceof Error?a.message:"Failed to load blog data",console.error("Error loading blog data:",a)}finally{o.value=!1}},getPostBySlug:C,setCurrentPost:m,setCurrentPostBySlug:function(e){m(C(e)||null)},setSearchQuery:function(e){s.value=e},setSelectedCategory:function(e){n.value=e},setSelectedTag:function(e){u.value=e},clearFilters:function(){s.value="",n.value=null,u.value=null},getPostsByCategory:function(e){return i.value.filter(t=>t.category.toLowerCase()===e.toLowerCase()||c.value.find(t=>t.id===e)?.name===t.category)},getPostsByTag:function(e){return i.value.filter(t=>t.tags.some(t=>t.toLowerCase()===e.toLowerCase()))},searchPosts:function(e){const t=e.toLowerCase();return i.value.filter(e=>e.title.toLowerCase().includes(t)||e.excerpt.toLowerCase().includes(t)||e.content.toLowerCase().includes(t)||e.tags.some(e=>e.toLowerCase().includes(t)))},formatDate:function(e,t="zh"){const a=new Date(e);return"en"===t?a.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):a.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})},getReadTimeText:function(e,t="zh"){return"en"===t?`${e} min read`:`${e} 分钟阅读`}}});export{o as u};
