import{s as e,r as s,c as a,C as t,D as l,l as n,p as o,u as c,A as d,v as r,B as i,V as u,T as y,U as v,J as m,F as p,z as h,q as g}from"./vue-CRY8e6yQ.js";import{a as b,u as f,_ as k}from"./index-CmndrdId.js";import"./vendor-BzQRwhDR.js";import"./gun-YLGCaVQN.js";const w={class:"relay-page"},N={class:"hero-section"},C={class:"hero-container"},L={class:"hero-content"},M={class:"hero-title"},j={class:"hero-subtitle"},R={class:"hero-status"},F={class:"status-text"},x={class:"stats-section"},T={class:"stats-container"},B={class:"stats-grid"},S={class:"stat-card"},_={class:"stat-content"},A={class:"stat-number"},$={class:"stat-label"},z={class:"stat-card"},D={class:"stat-content"},I={class:"stat-number"},U={class:"stat-label"},q={class:"stat-card"},H={class:"stat-content"},J={class:"stat-number"},V={class:"stat-label"},E={class:"add-node-section"},G={class:"add-node-container"},K={class:"add-node-card"},O={class:"add-node-title"},P={class:"add-node-description"},Q={class:"form-group"},W={class:"form-label"},X=["placeholder"],Y={class:"form-actions"},Z=["disabled"],ee={key:0,class:"loading-spinner"},se=["disabled"],ae={class:"nodes-section"},te={class:"nodes-container"},le={class:"nodes-header"},ne={class:"nodes-title"},oe=["disabled"],ce=["disabled"],de={class:"nodes-grid"},re={class:"node-header"},ie={class:"node-status"},ue={class:"status-label"},ye=["onClick","disabled","title"],ve=["onClick","title"],me={class:"node-content"},pe={class:"node-url"},he={class:"node-info"},ge={class:"node-domain"},be={key:0,class:"empty-state"},fe={class:"empty-title"},ke={class:"empty-description"},we={class:"toast-content"},Ne={class:"toast-message"},Ce=k(e({__name:"relaypage",setup(e){const{t:k}=b(),{isReady:Ce,relayNodes:Le,connectedNodes:Me,nodeStatus:je,nodeLatency:Re,addRelayNode:Fe,removeRelayNode:xe,resetToDefaultNodes:Te,updateNodeStatuses:Be,loadDefaultRelayNodes:Se,testAllNodesLatency:_e,testSingleNodeLatency:Ae}=f(),$e=s(""),ze=s(!1),De=s(!1),Ie=s(!1),Ue=s({show:!1,message:"",type:"success"}),qe=a(()=>0===Le.value.length?0:Math.round(Me.value.length/Le.value.length*100)),He=(e,s="success")=>{Ue.value={show:!0,message:e,type:s},setTimeout(()=>{Je()},3e3)},Je=()=>{Ue.value.show=!1},Ve=e=>{switch(e){case"connected":return k("relay.status.connected");case"connecting":return k("relay.status.connecting");default:return k("relay.status.disconnected")}},Ee=e=>{try{return new URL(e).hostname}catch{return e}},Ge=async()=>{if($e.value.trim()){ze.value=!0;try{await Fe($e.value.trim()),$e.value="",He(k("relay.messages.nodeAdded"),"success")}catch(e){He(k("relay.messages.addFailed"),"error")}finally{ze.value=!1}}},Ke=async()=>{De.value=!0;try{await Te(),He(k("relay.messages.nodesReset"),"success")}catch(e){He(k("relay.messages.resetFailed"),"error")}finally{De.value=!1}},Oe=async()=>{try{const e=await Se();He(`${k("relay.messages.jsonReloaded")}: ${e.length} ${k("relay.messages.nodesLoaded")}`,"success")}catch(e){He(k("relay.messages.reloadFailed"),"error")}},Pe=s(!1),Qe=async()=>{if(!Pe.value){Pe.value=!0;try{await _e(),He(k("relay.messages.latencyTested"),"success")}catch(e){He(k("relay.messages.latencyTestFailed"),"error")}finally{Pe.value=!1}}},We=s(null),Xe=e=>{const s=Re.value[e];return s&&null!==s.latency?`${s.latency}ms`:k("relay.latency.notTested")},Ye=e=>{const s=Re.value[e];if(!s||null===s.latency)return"latency-unknown";const a=s.latency;return a<100?"latency-good":a<300?"latency-medium":"latency-poor"},Ze=async()=>{Ie.value=!0;try{await Be(),He(k("relay.messages.statusRefreshed"),"info")}catch(e){He(k("relay.messages.refreshFailed"),"error")}finally{Ie.value=!1}};let es=null;return t(async()=>{await Be(),es=setInterval(()=>{Ie.value||Be()},3e4)}),l(()=>{es&&clearInterval(es)}),(e,s)=>(g(),n("div",w,[o("section",N,[o("div",C,[o("div",L,[o("h1",M,d(r(k)("relay.title")),1),o("p",j,d(r(k)("relay.description")),1),o("div",R,[o("div",{class:i(["status-indicator",{active:r(Ce)}])},null,2),o("span",F,d(r(Ce)?r(k)("relay.status.connected"):r(k)("relay.status.disconnected")),1)])])])]),o("section",x,[o("div",T,[o("div",B,[o("div",S,[s[1]||(s[1]=o("div",{class:"stat-icon"},"üåê",-1)),o("div",_,[o("div",A,d(r(Le).length),1),o("div",$,d(r(k)("relay.stats.totalNodes")),1)])]),o("div",z,[s[2]||(s[2]=o("div",{class:"stat-icon"},"‚úÖ",-1)),o("div",D,[o("div",I,d(r(Me).length),1),o("div",U,d(r(k)("relay.stats.connectedNodes")),1)])]),o("div",q,[s[3]||(s[3]=o("div",{class:"stat-icon"},"‚ö°",-1)),o("div",H,[o("div",J,d(qe.value)+"%",1),o("div",V,d(r(k)("relay.stats.connectionRate")),1)])])])])]),o("section",E,[o("div",G,[o("div",K,[o("h2",O,d(r(k)("relay.addNode.title")),1),o("p",P,d(r(k)("relay.addNode.description")),1),o("form",{onSubmit:u(Ge,["prevent"]),class:"add-node-form"},[o("div",Q,[o("label",W,d(r(k)("relay.addNode.urlLabel")),1),y(o("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>$e.value=e),type:"url",class:"form-input",placeholder:r(k)("relay.addNode.placeholder"),required:""},null,8,X),[[v,$e.value]])]),o("div",Y,[o("button",{type:"submit",class:"primary-button",disabled:ze.value||!$e.value.trim()},[ze.value?(g(),n("span",ee)):c("",!0),m(" "+d(ze.value?r(k)("relay.addNode.adding"):r(k)("relay.addNode.add")),1)],8,Z),o("button",{type:"button",onClick:Ke,class:"secondary-button",disabled:De.value},d(De.value?r(k)("relay.actions.resetting"):r(k)("relay.actions.reset")),9,se),o("button",{type:"button",onClick:Oe,class:"secondary-button"},d(r(k)("relay.actions.reloadFromJson")),1)])],32)])])]),o("section",ae,[o("div",te,[o("div",le,[o("h2",ne,d(r(k)("relay.nodesList.title")),1),o("button",{onClick:Ze,class:"refresh-button",disabled:Ie.value},[(g(),n("svg",{class:i(["refresh-icon",{spinning:Ie.value}]),viewBox:"0 0 24 24",fill:"none"},s[4]||(s[4]=[o("path",{d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]),2)),m(" "+d(r(k)("relay.actions.refresh")),1)],8,oe),o("button",{onClick:Qe,class:"refresh-button",disabled:Pe.value},[(g(),n("svg",{class:i(["refresh-icon",{spinning:Pe.value}]),viewBox:"0 0 24 24",fill:"none"},s[5]||(s[5]=[o("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]),2)),m(" "+d(Pe.value?r(k)("relay.actions.testing"):r(k)("relay.actions.testLatency")),1)],8,ce)]),o("div",de,[(g(!0),n(p,null,h(r(Le),e=>(g(),n("div",{key:e,class:i(["node-card",{connected:"connected"===r(je)[e],connecting:"connecting"===r(je)[e],disconnected:"disconnected"===r(je)[e]}])},[o("div",re,[o("div",ie,[o("div",{class:i(["status-dot",r(je)[e]||"disconnected"])},null,2),o("span",ue,d(Ve(r(je)[e]||"disconnected")),1)]),o("button",{onClick:s=>(async e=>{if(!We.value){We.value=e;try{await Ae(e),He(k("relay.messages.singleLatencyTested"),"success")}catch(s){He(k("relay.messages.latencyTestFailed"),"error")}finally{We.value=null}}})(e),class:"remove-button",disabled:We.value===e,title:r(k)("relay.actions.testSingleLatency")},s[6]||(s[6]=[o("svg",{viewBox:"0 0 24 24",fill:"none"},[o("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),8,ye),o("button",{onClick:s=>(async e=>{try{await xe(e),He(k("relay.messages.nodeRemoved"),"success")}catch(s){He(k("relay.messages.removeFailed"),"error")}})(e),class:"remove-button",title:r(k)("relay.actions.remove")},s[7]||(s[7]=[o("svg",{viewBox:"0 0 24 24",fill:"none"},[o("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),8,ve)]),o("div",me,[o("div",pe,d(e),1),o("div",he,[o("span",ge,d(Ee(e)),1),o("div",{class:i(["node-latency",Ye(e)])},d(Xe(e)),3)])])],2))),128))]),0===r(Le).length?(g(),n("div",be,[s[8]||(s[8]=o("div",{class:"empty-icon"},"üåê",-1)),o("h3",fe,d(r(k)("relay.empty.title")),1),o("p",ke,d(r(k)("relay.empty.description")),1)])):c("",!0)])]),Ue.value.show?(g(),n("div",{key:0,class:i(["toast",Ue.value.type])},[o("div",we,[o("span",Ne,d(Ue.value.message),1),o("button",{onClick:Je,class:"toast-close"},s[9]||(s[9]=[o("svg",{viewBox:"0 0 24 24",fill:"none"},[o("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))])],2)):c("",!0)]))}}),[["__scopeId","data-v-987470cc"]]);export{Ce as default};
