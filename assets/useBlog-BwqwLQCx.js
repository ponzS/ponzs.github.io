import{u as e}from"./index-DaoSW1E7.js";import{c as t,r as a}from"./vue-D4wD2Vkb.js";const o=a(null),s=a(!1),r=a(null);function l(){const{locale:a}=e(),l=t(()=>o.value?.posts||[]),n=t(()=>l.value.filter(e=>e.featured)),u=t(()=>[...l.value].sort((e,t)=>new Date(t.publishDate).getTime()-new Date(e.publishDate).getTime()).slice(0,6)),c=t(()=>o.value?.categories||[]),g=t(()=>o.value?.tags||[]);return{blogData:o,loading:s,error:r,posts:l,featuredPosts:n,latestPosts:u,categories:c,tags:g,loadBlogData:async()=>{s.value=!0,r.value=null;try{const e=await fetch("en"===a.value?"/data/blog-en.json":"/data/blog-zh.json");if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();o.value=t}catch(e){r.value=e instanceof Error?e.message:"Failed to load blog data",console.error("Error loading blog data:",e)}finally{s.value=!1}},getPostsByCategory:e=>l.value.filter(t=>t.category.toLowerCase()===e.toLowerCase()||c.value.find(t=>t.id===e)?.name===t.category),getPostsByTag:e=>l.value.filter(t=>t.tags.some(t=>t.toLowerCase()===e.toLowerCase())),getPostBySlug:e=>l.value.find(t=>t.slug===e),searchPosts:e=>{const t=e.toLowerCase();return l.value.filter(e=>e.title.toLowerCase().includes(t)||e.excerpt.toLowerCase().includes(t)||e.content.toLowerCase().includes(t)||e.tags.some(e=>e.toLowerCase().includes(t)))},getRelatedPosts:(e,t=3)=>l.value.filter(t=>t.id!==e.id&&(t.category===e.category||t.tags.some(t=>e.tags.includes(t)))).slice(0,t),formatDate:e=>new Date(e).toLocaleDateString("en"===a.value?"en-US":"zh-CN",{year:"numeric",month:"long",day:"numeric"}),getReadTimeText:e=>"en"===a.value?`${e} min read`:`${e} 分钟阅读`,getCategoryStats:()=>{const e=new Map;return l.value.forEach(t=>{const a=e.get(t.category)||0;e.set(t.category,a+1)}),Array.from(e.entries()).map(([e,t])=>({category:e,count:t}))},getTagStats:()=>{const e=new Map;return l.value.forEach(t=>{t.tags.forEach(t=>{const a=e.get(t)||0;e.set(t,a+1)})}),Array.from(e.entries()).map(([e,t])=>({tag:e,count:t})).sort((e,t)=>t.count-e.count)}}}export{l as u};
